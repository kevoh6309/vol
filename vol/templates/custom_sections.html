{% extends 'base.html' %}
{% block title %}Custom Sections | Resume Builder{% endblock %}
{% block content %}
<h2 class="mb-4">Custom Resume Sections</h2>
<div class="mb-3">
  <button class="btn btn-outline-primary">Add Section</button>
  <button class="btn btn-outline-warning ms-2" {% if not is_premium %}disabled{% endif %}>Advanced Section (Premium)</button>
  {% if not is_premium %}
    <span class="text-warning ms-2">Upgrade for advanced custom section features.</span>
  {% endif %}
</div>
<div class="alert alert-info text-center mb-4">
  <i class="bi bi-lock-fill text-warning"></i> <strong>Upgrade to Premium</strong> to unlock advanced custom sections!
</div>
<div id="customSections" class="row g-4">
  <!-- Sections will be rendered here -->
</div>
<!-- Add Section Modal -->
<div class="modal fade" id="addSectionModal" tabindex="-1" aria-labelledby="addSectionModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addSectionModalLabel">Add Custom Section</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="sectionForm">
          <div class="mb-3">
            <label class="form-label">Section Title</label>
            <input type="text" class="form-control" id="sectionTitle" required placeholder="e.g. Projects, Publications, Volunteer Work">
          </div>
          <div class="mb-3">
            <label class="form-label">Content</label>
            <textarea class="form-control" id="sectionContent" rows="2" required></textarea>
          </div>
          <button type="submit" class="btn btn-success w-100">Save Section</button>
        </form>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const key = 'customSections';
function getSections() {
  return JSON.parse(localStorage.getItem(key) || '[]');
}
function saveSections(sections) {
  localStorage.setItem(key, JSON.stringify(sections));
}
function renderSections() {
  const sections = getSections();
  const container = document.getElementById('customSections');
  container.innerHTML = '';
  if (sections.length === 0) {
    container.innerHTML = '<div class="col-12"><div class="alert alert-info">No custom sections yet. Click "Add Section" to get started!</div></div>';
    return;
  }
  sections.forEach((s, i) => {
    const card = document.createElement('div');
    card.className = 'col-md-6 col-lg-4';
    card.innerHTML = `
      <div class="card shadow-sm transition h-100">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title mb-2"><i class="bi bi-bookmark-star me-2 text-primary"></i>${s.title}</h5>
          <p class="mb-2">${s.content}</p>
          <button class="btn btn-outline-danger btn-sm mt-auto" onclick="deleteSection(${i})"><i class="bi bi-trash"></i> Delete</button>
        </div>
      </div>
    `;
    container.appendChild(card);
  });
}
function deleteSection(idx) {
  const sections = getSections();
  sections.splice(idx, 1);
  saveSections(sections);
  renderSections();
}
document.getElementById('sectionForm').onsubmit = function(e) {
  e.preventDefault();
  const title = document.getElementById('sectionTitle').value.trim();
  const content = document.getElementById('sectionContent').value.trim();
  if (!title || !content) return;
  const sections = getSections();
  sections.push({title, content});
  saveSections(sections);
  renderSections();
  document.getElementById('sectionForm').reset();
  bootstrap.Modal.getInstance(document.getElementById('addSectionModal')).hide();
};
renderSections();
</script>
{% endblock %} 