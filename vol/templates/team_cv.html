{% extends 'base.html' %}
{% block title %}Team CV Generator | Resume Builder{% endblock %}
{% block content %}
<h2 class="mb-4">Team CV Generator</h2>
<div class="mb-3 d-flex justify-content-between align-items-center">
  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMemberModal"><i class="bi bi-plus-lg me-1"></i>Add Team Member</button>
  <div class="btn-group">
    <button type="button" class="btn btn-outline-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
      Export Team CV
    </button>
    <ul class="dropdown-menu">
      <li><a class="dropdown-item" href="#" onclick="showPremiumUpsell()">PDF (Free <i class='bi bi-water'></i>)</a></li>
      <li><a class="dropdown-item" href="#" onclick="showPremiumUpsell()">Word (.docx) (Free <i class='bi bi-water'></i>)</a></li>
      <li><hr class="dropdown-divider"></li>
      <li><a class="dropdown-item disabled" href="#">PDF (No Watermark <i class='bi bi-lock-fill text-warning'></i> Premium)</a></li>
      <li><a class="dropdown-item disabled" href="#">Word (No Watermark <i class='bi bi-lock-fill text-warning'></i> Premium)</a></li>
    </ul>
  </div>
</div>
<div id="teamMembers" class="row g-4">
  <!-- Team members will be rendered here -->
</div>
<!-- Add Member Modal -->
<div class="modal fade" id="addMemberModal" tabindex="-1" aria-labelledby="addMemberModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addMemberModalLabel">Add Team Member</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="memberForm">
          <div class="mb-3">
            <label class="form-label">Name</label>
            <input type="text" class="form-control" id="memberName" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Role</label>
            <input type="text" class="form-control" id="memberRole" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Bio</label>
            <textarea class="form-control" id="memberBio" rows="2" required></textarea>
          </div>
          <button type="submit" class="btn btn-success w-100">Save Member</button>
        </form>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const key = 'teamMembers';
function getMembers() {
  return JSON.parse(localStorage.getItem(key) || '[]');
}
function saveMembers(members) {
  localStorage.setItem(key, JSON.stringify(members));
}
function renderMembers() {
  const members = getMembers();
  const container = document.getElementById('teamMembers');
  container.innerHTML = '';
  if (members.length === 0) {
    container.innerHTML = '<div class="col-12"><div class="alert alert-info">No team members yet. Click "Add Team Member" to get started!</div></div>';
    return;
  }
  members.forEach((m, i) => {
    const card = document.createElement('div');
    card.className = 'col-md-6 col-lg-4';
    card.innerHTML = `
      <div class="card shadow-sm transition h-100">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title mb-2"><i class="bi bi-person-badge me-2 text-primary"></i>${m.name}</h5>
          <p class="mb-2"><strong>Role:</strong> ${m.role}</p>
          <p class="mb-2 text-muted">${m.bio}</p>
          <button class="btn btn-outline-danger btn-sm mt-auto" onclick="deleteMember(${i})"><i class="bi bi-trash"></i> Delete</button>
        </div>
      </div>
    `;
    container.appendChild(card);
  });
}
function deleteMember(idx) {
  const members = getMembers();
  members.splice(idx, 1);
  saveMembers(members);
  renderMembers();
}
document.getElementById('memberForm').onsubmit = function(e) {
  e.preventDefault();
  const name = document.getElementById('memberName').value.trim();
  const role = document.getElementById('memberRole').value.trim();
  const bio = document.getElementById('memberBio').value.trim();
  if (!name || !role || !bio) return;
  const members = getMembers();
  members.push({name, role, bio});
  saveMembers(members);
  renderMembers();
  document.getElementById('memberForm').reset();
  bootstrap.Modal.getInstance(document.getElementById('addMemberModal')).hide();
};
renderMembers();
function showPremiumUpsell() {
  alert('Upgrade to Premium to unlock export for Team CVs!');
}
</script>
{% endblock %} 